<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Librairie Discret</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="stylesheet" href="https://discretlib.github.io/doc/index.css">
  
</head>

<body>
  <section class="header-background"></section>
  <section class="content">
    <section class="header">
      <ul>
        <li>
          
          <a href="https://discretlib.github.io/doc/fr/" class="discret">
            Discret
          </a>
        </li>
        <li>
          <section class="learn">
            <a href="#">
              Tutoriels<i class="fa fa-caret-down"></i>
            </a>
            <section class="learn_menu">
              <ul>
                
                <li>
                  <a href="https://discretlib.github.io/doc/fr/tutorial/">
                    Sommaire
                  </a>
                </li>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/fr/tutorial/rust/">
                    Commencer avec Rust
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/tutorial/rust/instal/">
                      Installation
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/tutorial/rust/rust-chat/">
                      Chat Minimaliste
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/fr/tutorial/flutter/">
                    Commencer avec Flutter
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/tutorial/flutter/instal/">
                      Installer les composants
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/tutorial/flutter/flutter-chat/">
                      Chat Flutter Minimaliste
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/tutorial/flutter/flutter-multiuser-chat/">
                      Chat multi utilisateurs
                    </a>
                  </li>
                  
                </ul>
                
                
              </ul>
            </section>
          </section>
        </li>
        <li>
          <section class="learn">
            <a href="">
              Apprendre
              <i class="fa fa-caret-down"></i>
            </a>

            <section class="learn_menu">
              <ul>
                
                <li>
                  <a href="https://discretlib.github.io/doc/fr/learn/">
                    Sommaire
                  </a>
                </li>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/fr/learn/datamodel/">
                    Gestion des Données
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/learn/datamodel/schema/">
                      Schémas et Entités
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/learn/datamodel/mutation/">
                      Mutations et Suppression
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/learn/datamodel/query/">
                      Requêtes
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/fr/learn/access_rights/">
                    Droits d&#x27;accès
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/learn/access_rights/room/">
                      Rooms
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/learn/access_rights/peer/">
                      Gestion des Pairs
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/learn/access_rights/invites/">
                      Invitations
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/fr/learn/configuration/">
                    Configuration
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/learn/configuration/configuration/">
                      Configuration
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/learn/configuration/hardware/">
                      Identifiants d&#x27;appareil
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/fr/learn/configuration/beacon/">
                      Le serveur Beacon
                    </a>
                  </li>
                  
                </ul>
                
                
                <li >
                  <a href="https://discretlib.github.io/doc/fr/learn/events/">
                    Evènements système
                  </a>
                </li>
                
              </ul>
            </section>
          </section>
        </li>

        <section class="header_right">
          <li><a href="">Me Recruter</a></li>
          <li><a href="/" class="flag"><img src="/gb.svg" alt="english translation" /></a>
          </li>


        </section>
      </ul>
    </section>


    

<section class="sticky">
    <nav class="menu">
        
        <ul>
            
            <li >
                <a href="https://discretlib.github.io/doc/fr/learn/">
                    Sommaire
                </a>
            </li>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/fr/learn/datamodel/">
                    Gestion des Données
                </a>
            </li>
            <ul class="sub_menu">
                
                <li >
                    <a href="https://discretlib.github.io/doc/fr/learn/datamodel/schema/">
                        Schémas et Entités
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/fr/learn/datamodel/mutation/">
                        Mutations et Suppression
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/fr/learn/datamodel/query/">
                        Requêtes
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/fr/learn/access_rights/">
                    Droits d&#x27;accès
                </a>
            </li>
            <ul class="sub_menu">
                
                <li >
                    <a href="https://discretlib.github.io/doc/fr/learn/access_rights/room/">
                        Rooms
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/fr/learn/access_rights/peer/">
                        Gestion des Pairs
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/fr/learn/access_rights/invites/">
                        Invitations
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/fr/learn/configuration/">
                    Configuration
                </a>
            </li>
            <ul class="sub_menu">
                
                <li class="active" >
                    <a href="https://discretlib.github.io/doc/fr/learn/configuration/configuration/">
                        Configuration
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/fr/learn/configuration/hardware/">
                        Identifiants d&#x27;appareil
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/fr/learn/configuration/beacon/">
                        Le serveur Beacon
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/fr/learn/events/">
                    Evènements système
                </a>
            </li>
            
        </ul>
        
    </nav>
</section>

<article>
    <h1>
        Configuration
    </h1>
    <p><em>Discret</em> propose un certain nombre d'options de configuration qui sont passées au démarage du système.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">parallelism</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Définit le niveau parallélisme de l'application. Ce nombre impacte:</p>
<ul>
<li>le nombre de <strong>Room</strong> qui peuvent être synchronisées en parallèle</li>
<li>le nombre de <em>threads</em> de lecture de la base de données</li>
<li>le nombre de <em>threads</em> de verification de signatures</li>
<li>le nombre de <em>buffers</em> utilisés pour lire et écrire les données sur le réseau</li>
<li>la taille des <em>channels</em> utilisés pour transmettre des messages entre les services internes</li>
</ul>
<p>Un plus grand nombre ca fournir de meilleures performances au prix d'une plus grande utilisation mémoire. Un nombre plus grand que le nombre de CPU ne devrait pas apporter de gains importants.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">auto_accept_local_device</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Lorsque vous vous connectez avec le même secrets sur deux appareils différents, ces deux appareils s'échangent une signature matérielle pour vérifier qu'ils sont authorisés à se connecter. </p>
<p>Cela ajoute un niveau additionel de sécurité dans le cas où votre secret serait aussi utilisé par une autre personne sur Internet. Cela peut arriver dans le cas où vos utlisateur utilisent des mots de passe faibles. </p>
<p>Si la connection se fait sur internet, un nouvel appareil sera toujours rejeté.</p>
<p>Par contre, sur un réseau local un nouvel appareil sera authorisé par défaut. Ce comportement peut être désactivé en modifiant 'auto_accept_local_device' à false.
Dans ce cas, quand un nouvel appareil est détecté sur le réseau local:</p>
<ul>
<li>un tuple <strong>sys.AllowedHardware</strong> sera créé avec le status:'pending'</li>
<li>un évènement <strong>PendingHardware</strong> sera déclenché</li>
<li>la tentative de connection sera rejetée</li>
</ul>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">auto_allow_new_peers</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Définit le comportement de <em>Discret</em> quand il découvre un nouveau pair lors de la synchronisation des <strong>Rooms</strong></p>
<p>auto_allow_new_peers=true:</p>
<ul>
<li>Je fais confiance aux amis de mes amis et ceux-ci seront authorisés à se connecter directement à mes appareils. </li>
</ul>
<p>auto_allow_new_peers=false:</p>
<ul>
<li>par défaut, les amis de mes amis ne sont pas authorisés à se connecter à mes apparareils. C'est la configuration par défaut.</li>
</ul>
<p>Par exemple, imaginons que vous avez invités Bob à discuter avec vous. Bob crée un groupe de discussion avec vous et Alice. Lors de la première synchronisation, <em>Discret</em>  va détecter un nouveau pair nommé Alice et va l'ajouter dans <strong>sys.Peer</strong>.</p>
<p>Si  auto_allow_new_peers est 'true', <em>Discret</em> va l'ajouter dans <strong>sys.AllowedPeer</strong> avec le status <strong>enabled</strong>, et l'authoriser à se connecter directement. Cela rend le réseau plus efficace car Alice pourra voir vos nouveaux messages même quand Bob ne sera pas connecté. Par contre cela se fait au prix d'une perte de vie privée car Alice connaitra votre adresse IP. </p>
<p>Si auto_allow_new_peers est 'false',</p>
<ul>
<li>un tuple <strong>sys.AllowedPeer</strong> est créé avec le status <strong>pending</strong>, is created in the private room, with the status set to 'pending'</li>
<li>un événement <strong>PendingPeer</strong> est déclenché.</li>
</ul>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">max_object_size_in_kb</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Definit la taille maximum d'un tuple. Les tuples doivent avoir une taille raisonable pour garantir une synchronisation efficace.
Cet paramètre impacte la taille des <em>buffers</em> utilisés pour lire et écrire des données sur le réseau.</p>
<p><strong>/!Attention!\</strong> une fois votre programme en production, diminuer cette valeur cassera <em>Discret</em>. Aucune donnée ne sera perdue mais le système ne pourra plus synchroniser les tuples plus grand que cette valeur.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">read_cache_size_in_kb</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Définit la taille maximum des caches de lecture de la base de données. Augmenter cette valeur peut améliorer les performance. Chaque <em>thread</em> de lecture va utiliser cette
quantité mémoire.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">write_cache_size_in_kb</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Définit la taille maximum du caches d'écriture de la base de données. Augmenter cette valeur peut améliorer les performance.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">write_buffer_length</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Les requêtes d'écriture en base de données sont écrite par bloc. Quand le process d'écriture est prêt, il récupère toutes les requêtes en attente jusqu'a atteindre la limite définie par ce paramêtre. Ce bloc de requête sera ensuite effectué dans une unique transaction. Cela augmente énormément les performances, comparé à l'écriture des requêtes une par une (autocommit).</p>
<p>Pour donner une idée de l'amélioration des performance, un test d'insertion de 100 000 tuples donne le résultat suivant:</p>
<ul>
<li>write_buffer_length = 1       Insertions/secondes: 55  &lt;- cela insère les données une par une</li>
<li>write_buffer_length = 10      Insertions/secondes: 500</li>
<li>write_buffer_length = 100     Insertions/secondes: 3000</li>
<li>write_buffer_length = 1000    Insertions/secondes: 32000</li>
</ul>
<p>Si une requête échoue au sein d'un bloc, la transaction sera annulée et toutes les autre requêtes échoueront. Cela ne devrait pas être un problèmes car les requêtes d'écriture n'échouent qu'en cas de problème matériel (plus de place sur le disque dur, par exemple) ou de <em>Bug</em>. Dans les deux cas, cela ne pose pas de problème d'annuler tout un bloc de données.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">announce_frequency_in_ms</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>La fréquence (en millisecondes) à laquelle des annonces sont envoyés sur le réseau pour trouver vos pairs.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">enable_multicast</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Active/désactive la decouverte de vos pairs sur le réseau local</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">multicast_ipv4_interface</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-support z-class z-builtin z-ts">String</span>
</span></code></pre>
<p><em>Discret</em> utilise la fonction <em>IP multicast</em> pour découvrir vos pairs sur le réseau local.Sur certain système avec plusieurs cartes réseau, il pourrait être necessaire d'indiquer votre adresse IP locale pour que le <em>multicast</em> fonctionne. La valeur par défaut (laisser le système d'exploitation se débrouiller) devrait néanmoins fonctionner dans la plupart des cas. </p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"> <span class="z-entity z-name z-label z-ts">multicast_ipv4_group</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-support z-class z-builtin z-ts">String</span>
</span></code></pre>
<p>Le groupe <em>IP multicast</em> utilisé. </p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">pub</span> <span class="z-entity z-name z-label z-ts">enable_beacons</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Active/désactive la decouverte de vos pairs  sur internet.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">pub</span> <span class="z-entity z-name z-label z-ts">beacons</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">List</span><span class="z-keyword z-operator z-relational z-ts">&lt;</span><span class="z-variable z-other z-readwrite z-ts">BeaconConfig</span><span class="z-keyword z-operator z-relational z-ts">&gt;</span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></code></pre>
<p>Liste des serveur <em>Beacon</em> utilisés pour découvrir vos Pairs sur internet.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">pub</span> <span class="z-entity z-name z-label z-ts">enable_database_memory_security</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Empêche la mémoire d'être écrite en <em>swap</em> et vide la mémoire(<em>zeroise</em>) quand elle est libérée.</p>
<p>Désactivé par défaut car cela impacte fortement les performances(d'environ 50%). Cela ne devrait être utilisé que si votre système demande un niveau de sécurité extrêmement élévé.</p>
<p>source: <a href="https://discuss.zetetic.net/t/what-is-the-purpose-of-pragma-cipher-memory-security/3953">cipher_memory_security</a></p>


    <nav class="lower_nav">
        <div>
        </div>
        <div><a href="https://discretlib.github.io/doc/fr/learn/configuration/hardware/">Suivant: Identifiants d&#x27;appareil <i
                    class="fa fa-arrow-right"></i></a> 
        </div>
    </nav>
</article>





  </section>
  <section class="footer">
    <div>
      Le design de ce site est une mauvaise copie du site <a href="https://www.mkdocs.org/">MkDocs</a>. 
      Le language de requête est très fortement inspiré de <a href="https://graphql.org/">GraphQL</a>.
    </div>

    <div> 
      Copyright © 2024 Adrien SALAIS. Le contenu de ce site est sous licence <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.fr">CC-BY-SA</a>.
      La librairie Discret est sous licence <a href="https://www.gnu.org/licenses/agpl-3.0.fr.html">AGPL V3</a>. 
      Les exemples et le *binding* Flutter est sous licence <a href="https://en.wikipedia.org/wiki/MIT_License">MIT</a> 
    <div />
  </section>
</body>

</html>
