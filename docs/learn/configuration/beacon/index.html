<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Discret Library</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="stylesheet" href="https://discretlib.github.io/doc/index.css">
  
</head>

<body>
  <section class="content">
    <section class="header">
      <ul>
        <li>
          
          <a href="https://discretlib.github.io/doc/" class="discret">
            Discret
          </a>
        </li>
        <li>
         <section class="learn">
            <a href="#">
              Tutorials<i class="fa fa-caret-down"></i>
            </a>
            <section class="learn_menu">
              <ul>
                
                <li>
                  <a href="https://discretlib.github.io/doc/tutorial/">
                    Table Of Content
                  </a>
                </li>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/tutorial/rust/">
                    Getting started with Rust
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/tutorial/rust/instal/">
                      Installation
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/tutorial/rust/rust-chat/">
                      Minimalist Rust Chat
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/tutorial/flutter/">
                    Getting Started with Flutter
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/tutorial/flutter/instal/">
                      Installing Components
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/tutorial/flutter/flutter-chat/">
                      Minimalist Flutter Chat
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/tutorial/flutter/flutter-multiuser-chat/">
                      Flutter chat with multiple users
                    </a>
                  </li>
                  
                </ul>
                
                
              </ul>
            </section>
          </section>
        </li>
        <li>
          <section class="learn">
            <a href="#">
              Learn
              <i class="fa fa-caret-down"></i>
            </a>

            <section class="learn_menu">
              <ul>
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/">
                    Table Of Content
                  </a>
                </li>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/datamodel/">
                    Managing data
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/datamodel/schema/">
                      Schema and Entities
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/datamodel/mutation/">
                      Mutations and Deletions
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/datamodel/query/">
                      Queries
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/access_rights/">
                    Access Rights
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/access_rights/room/">
                      Rooms
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/access_rights/peer/">
                      Peer Management
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/access_rights/invites/">
                      Invitations
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/configuration/">
                    Configuration
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/configuration/configuration/">
                      Configuration
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/configuration/hardware/">
                      Hardware Key
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/configuration/beacon/">
                      The Beacon Server
                    </a>
                  </li>
                  
                </ul>
                
                
                <li >
                  <a href="https://discretlib.github.io/doc/learn/events/">
                    System Events
                  </a>
                </li>
                
              </ul>
            </section>
          </section>
        </li>

        <section class="header_right">
          
          <li><a  href="https://discretlib.github.io/doc/hire_me/">Hire Me</a></li>
          <li><a href="/doc/fr/" class="flag"><img src="/doc/fr.svg" alt="french" /></a>
        </section>
      </ul>
    </section>


    

<section class="sticky">
    <nav class="menu">
        
        <ul>
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/">
                    Table Of Content
                </a>
            </li>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/datamodel/">
                    Managing data
                </a>
            </li>
            <ul class="sub_menu">
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/datamodel/schema/">
                        Schema and Entities
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/datamodel/mutation/">
                        Mutations and Deletions
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/datamodel/query/">
                        Queries
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/access_rights/">
                    Access Rights
                </a>
            </li>
            <ul class="sub_menu">
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/access_rights/room/">
                        Rooms
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/access_rights/peer/">
                        Peer Management
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/access_rights/invites/">
                        Invitations
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/configuration/">
                    Configuration
                </a>
            </li>
            <ul class="sub_menu">
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/configuration/configuration/">
                        Configuration
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/configuration/hardware/">
                        Hardware Key
                    </a>
                </li>
                
                <li class="active" >
                    <a href="https://discretlib.github.io/doc/learn/configuration/beacon/">
                        The Beacon Server
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/events/">
                    System Events
                </a>
            </li>
            
        </ul>
        
    </nav>
</section>

<article>
    <h1>
        The Beacon Server
    </h1>
    <p>On a local network, <strong>Discret</strong> can discover other peers without any specific hardware. But when peers are connecting over Internet a meeting server named beacon is required to allow peers to discover each others.</p>
<p>The beacon server works as follow. Let's suppose that Alice and Bob want's to connect:</p>
<ul>
<li>Alice sends a token known by Bog to the beacons server. The sever will keep this token until Alice disconnect herself.</li>
<li>Bob send the same token to the server.</li>
<li>The beacon server acknowledge that Alice and Bob share the same token:
<ul>
<li>it sends Alice's public IP address to Bob</li>
<li>And send Bob'as public IP address to Alice</li>
</ul>
</li>
<li>Alice and Bob know their respective public address and can initiate a connection.</li>
<li>Once connected Alice and Bob check their identity, because the shared token is not a proof of identity  but just a mean to find each others</li>
</ul>
<h1 id="hosting">Hosting</h1>
<p>The Beacon server is used to resolve public IP address of peers that want's to connect. It cannot be installed on your local local network because it will fail to resolve your public IP. It must be hosted elsewhere. </p>
<p>The server is not ressource intensive and can be hosted a cheap server as a start. For example:</p>
<ul>
<li>a free tier server from a cloud company,</li>
<li>a cheap virtual private server (VPS).</li>
<li>etc.</li>
</ul>
<h1 id="installation">Installation</h1>
<p>No pre-compiled binaries are available, you have to compile it yourself.</p>
<p>Starts by cloning the beacon repository:</p>
<pre class="z-code"><code><span class="z-text z-plain">git clone https://github.com/discretlib/discret_beacon.git
</span></code></pre>
<p>and then compile it, the compilation can take a few minutes:</p>
<pre class="z-code"><code><span class="z-text z-plain">cd discret_beacon
</span><span class="z-text z-plain">cargo build --release
</span></code></pre>
<p>The compiled server will be located in the  <em>./target/release/</em>. Its exact name depends on you OS, on Linux it is named  <strong>discret_beacon</strong>.</p>
<p>Copy the file in a folder of your choice, then run it. On Linux, the following command will start it as a background task:</p>
<pre class="z-code"><code><span class="z-text z-plain">nohup ./discret_beacon &amp;
</span></code></pre>
<h1 id="usage">Usage</h1>
<p>At first run, <em>Beacon</em> will create the following file and folders:</p>
<pre class="z-code"><code><span class="z-text z-plain">logs/
</span><span class="z-text z-plain">Beacon.conf.toml  
</span><span class="z-text z-plain">certificate_hash.txt  
</span><span class="z-text z-plain">cert_der.bin
</span><span class="z-text z-plain">log4rs.yml
</span></code></pre>
<ul>
<li><strong>logs/</strong>: the folder that contains the application logs.</li>
<li><strong>Beacon.conf.toml</strong>: the <strong>Beacon</strong> configuraiton file that allows to change the IPV4 and IPV6 listening port.</li>
<li><strong>certificate_hash.txt</strong>: a text file that contains the server's certificate hash. This hash is used to register the Beacon sever in the Discret <a href="https://discretlib.github.io/doc/learn/configuration/configuration/">configuration</a> </li>
<li><strong>cert_der.bin</strong>: the server certificate  and private key.</li>
<li><strong>log4rs.yml</strong>: The <a href="https://docs.rs/log4rs/latest/log4rs/">log4rs</a> configuration file.</li>
</ul>
<h1 id="backup-and-restore">Backup and Restore</h1>
<p>The <strong>cert_der.bin</strong> file should be backed up to be able to reconfigure a server in case of a crash.</p>
<p>If you need to recover after a crash:</p>
<ul>
<li>copy the backed up <strong>cert_der.bin</strong> in the <strong>discret_beacon</strong> folder,</li>
<li>run the server.</li>
</ul>
<h1 id="certificate-reuse">Certificate Reuse</h1>
<p>The <strong>cert_der.bin</strong> file can be used on several servers. For a production system, you will need to declare several Beacon server for failover.
To simplify deployment, you can use a single <strong>cert_der.bin</strong> for all the server which makes certificate management easier.</p>
<h1 id="discret-configuration">Discret configuration</h1>
<p>Let's suppose you have created three servers (firstbeacon.com, secondbeacon.com, thirdbeacon.com) with the same <strong>cert_der.bin</strong>.</p>
<p>A <strong>Discret</strong> client will be <a href="https://discretlib.github.io/doc/learn/configuration/configuration/">configured</a> as follow (we suppose that the configuration is stored in a TOML file):
The <strong>cert_hash</strong> is the value stored in the <strong>certificate_hash.txt</strong> file.</p>
<pre data-lang="toml" class="language-toml z-code"><code class="language-toml" data-lang="toml"><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">beacons</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span><span class="z-punctuation z-definition z-array z-begin z-toml">[</span>
</span><span class="z-source z-toml">  <span class="z-punctuation z-definition z-inline-table z-begin z-toml">{</span><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">hostname</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">&quot;</span>firstbeacon.com:4264<span class="z-punctuation z-definition z-string z-end z-toml">&quot;</span></span><span class="z-punctuation z-separator z-inline-table z-toml">,</span>       <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">cert_hash</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">&quot;</span>weOsoMPwj976xqxRvLElsbb-gijWWn0netOtgPflZnk<span class="z-punctuation z-definition z-string z-end z-toml">&quot;</span></span><span class="z-punctuation z-definition z-inline-table z-end z-toml">}</span><span class="z-punctuation z-separator z-array z-toml">,</span>
</span><span class="z-source z-toml">  <span class="z-punctuation z-definition z-inline-table z-begin z-toml">{</span><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">hostname</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">&quot;</span>secondbeacon.com:4264<span class="z-punctuation z-definition z-string z-end z-toml">&quot;</span></span><span class="z-punctuation z-separator z-inline-table z-toml">,</span>      <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">cert_hash</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">&quot;</span>weOsoMPwj976xqxRvLElsbb-gijWWn0netOtgPflZnk<span class="z-punctuation z-definition z-string z-end z-toml">&quot;</span></span><span class="z-punctuation z-definition z-inline-table z-end z-toml">}</span><span class="z-punctuation z-separator z-array z-toml">,</span>
</span><span class="z-source z-toml">  <span class="z-punctuation z-definition z-inline-table z-begin z-toml">{</span><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">hostname</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">&quot;</span>thirdbeacon.com:4264<span class="z-punctuation z-definition z-string z-end z-toml">&quot;</span></span><span class="z-punctuation z-separator z-inline-table z-toml">,</span>       <span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">cert_hash</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">&quot;</span>weOsoMPwj976xqxRvLElsbb-gijWWn0netOtgPflZnk<span class="z-punctuation z-definition z-string z-end z-toml">&quot;</span></span><span class="z-punctuation z-definition z-inline-table z-end z-toml">}</span><span class="z-punctuation z-separator z-array z-toml">,</span>
</span><span class="z-source z-toml"><span class="z-punctuation z-definition z-array z-end z-toml">]</span>
</span></code></pre>
<h1 id="beacon-conf-toml-configuration">Beacon.conf.toml Configuration</h1>
<p>This file contains only two parameters:</p>
<ul>
<li><strong>port</strong>: the IPV4 listening port,</li>
</ul>

    <nav class="lower_nav">
        <div> <a href="https://discretlib.github.io/doc/learn/configuration/hardware/"><i class="fa fa-arrow-left"></i> Previous:
                Hardware Key</a>
        </div>
        <div>
        </div>
    </nav>
</article>


<nav class="sticky">
    <section class="toc">
        <h1>On this page</h1>
        <ul>
            
            <li>
                <a href="https://discretlib.github.io/doc/learn/configuration/beacon/#hosting">Hosting</a>
            </li>
            
            <li>
                <a href="https://discretlib.github.io/doc/learn/configuration/beacon/#installation">Installation</a>
            </li>
            
            <li>
                <a href="https://discretlib.github.io/doc/learn/configuration/beacon/#usage">Usage</a>
            </li>
            
            <li>
                <a href="https://discretlib.github.io/doc/learn/configuration/beacon/#backup-and-restore">Backup and Restore</a>
            </li>
            
            <li>
                <a href="https://discretlib.github.io/doc/learn/configuration/beacon/#certificate-reuse">Certificate Reuse</a>
            </li>
            
            <li>
                <a href="https://discretlib.github.io/doc/learn/configuration/beacon/#discret-configuration">Discret configuration</a>
            </li>
            
            <li>
                <a href="https://discretlib.github.io/doc/learn/configuration/beacon/#beacon-conf-toml-configuration">Beacon.conf.toml Configuration</a>
            </li>
            
        </ul>
        <div class="wordcount">557 words, 3 min read</div>
    </section>
</nav>




  </section>
  <section class="footer">
    <div>
      The site design is a bad copy of the <a href="https://www.mkdocs.org/">MkDocs</a> website. 
      The query language is heavily inspired by <a href="https://graphql.org/">GraphQL</a>.
    </div>

    <div> 
      Copyright © 2024 Adrien SALAIS. This site content is under the <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">CC-BY-SA</a> licence.     
      The Discret library is under the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">AGPL V3</a> licence. 
      The examples and the Flutter binding are under the <a href="https://en.wikipedia.org/wiki/MIT_License">MIT</a> licence
      <div />
  </section>
</body>

</html>
