<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Discret</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta
  name="description"
  content="A Rust backend to create peer to peer (P2P) applications, using a GraphQL inspired syntax">
  
  <link rel="stylesheet" href="https://discretlib.github.io/doc/index.css">
  
</head>

<body>
  <section class="content">
    <section class="header">
      <ul>
        <li>
          
          <a href="https://discretlib.github.io/doc/" class="discret">
            Discret
          </a>
        </li>
        <li>
         <section class="learn">
            <a href="#">
              Tutorials
            </a>
            <section class="learn_menu">
              <ul>
                
                <li>
                  <a href="https://discretlib.github.io/doc/tutorial/">
                    Table Of Content
                  </a>
                </li>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/tutorial/rust/">
                    Getting started with Rust
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/tutorial/rust/instal/">
                      Installation
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/tutorial/rust/rust-chat/">
                      Minimalist Rust Chat
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/tutorial/flutter/">
                    Getting Started with Flutter
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/tutorial/flutter/instal/">
                      Installing Components
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/tutorial/flutter/flutter-chat/">
                      Minimalist Flutter Chat
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/tutorial/flutter/flutter-multiuser-chat/">
                      Flutter chat with multiple users
                    </a>
                  </li>
                  
                </ul>
                
                
              </ul>
            </section>
          </section>
        </li>
        <li>
          <section class="learn">
            <a href="#">
              Learn
            </a>

            <section class="learn_menu">
              <ul>
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/">
                    Table Of Content
                  </a>
                </li>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/datamodel/">
                    Managing data
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/datamodel/schema/">
                      Schema and Entities
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/datamodel/mutation/">
                      Mutations and Deletions
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/datamodel/query/">
                      Queries
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/access_rights/">
                    Access Rights
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/access_rights/room/">
                      Rooms
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/access_rights/peer/">
                      Peer Management
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/access_rights/invites/">
                      Invitations
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/configuration/">
                    Configuration
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/configuration/configuration/">
                      Configuration
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/configuration/hardware/">
                      Hardware Key
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/configuration/beacon/">
                      The Beacon Server
                    </a>
                  </li>
                  
                </ul>
                
                
                <li >
                  <a href="https://discretlib.github.io/doc/learn/events/">
                    System Events
                  </a>
                </li>
                
              </ul>
            </section>
          </section>
        </li>

        <section class="header_right">
          
          <li><a  href="https://discretlib.github.io/doc/hire_me/">Hire Me</a></li>
          <li><a href="/doc/fr/" class="flag"><img src="/doc/fr.svg" alt="french" /></a>
        </section>
      </ul>
    </section>


    

<section class="sticky">
    <nav class="menu">
        
        <ul>
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/">
                    Table Of Content
                </a>
            </li>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/datamodel/">
                    Managing data
                </a>
            </li>
            <ul class="sub_menu">
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/datamodel/schema/">
                        Schema and Entities
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/datamodel/mutation/">
                        Mutations and Deletions
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/datamodel/query/">
                        Queries
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/access_rights/">
                    Access Rights
                </a>
            </li>
            <ul class="sub_menu">
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/access_rights/room/">
                        Rooms
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/access_rights/peer/">
                        Peer Management
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/access_rights/invites/">
                        Invitations
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/configuration/">
                    Configuration
                </a>
            </li>
            <ul class="sub_menu">
                
                <li class="active" >
                    <a href="https://discretlib.github.io/doc/learn/configuration/configuration/">
                        Configuration
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/configuration/hardware/">
                        Hardware Key
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/configuration/beacon/">
                        The Beacon Server
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/events/">
                    System Events
                </a>
            </li>
            
        </ul>
        
    </nav>
</section>

<article>
    <h1>
        Configuration
    </h1>
    <p><em>Discret</em> provides some configuration options that will be passed to the engine at startup. </p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">parallelism</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Defines the global parallelism capabilities. This number impact:</p>
<ul>
<li>the maximum number of room that can be synchronized in parallel,</li>
<li>the number of database readings threads</li>
<li>the number of signature verification threads</li>
<li>the number of shared buffers used for reading and writing data on the network</li>
<li>the depth of the channels that are used to transmit message across services</li>
</ul>
<p>Larger numbers will provides better performances at the cost of more memory usage. Having a number larger that the number of CPU might not provides increased performances</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">auto_accept_local_device</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>When connecting with the same key_material on different devices, those devices exchanges their hardware fingerprint to check wether they are allowed to connect.
This add an extra layer of security in the unlucky case where your secret material is shared by another person on the internet (which could be relatively frequent as users tends use weak passwords).</p>
<p>When connecting over the internet, new hardware is always silently rejected.</p>
<p>However, on local network we trust new hardware by default. This behaviors can be disabled by setting 'auto_accept_local_device' to false.
In this case, when a new device is detected on the local network:</p>
<ul>
<li>a sys.AllowedHardware will be created with the status:'pending'</li>
<li>a PendingHardware Event will be triggered</li>
<li>the current connection attempt will be rejected</li>
</ul>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">auto_allow_new_peers</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Defines the behavior of the system when it discover a new peer while synchronizing a room.</p>
<p>auto_allow_new_peers=true:</p>
<ul>
<li>I implicitly trust friends of my friends. It is easy to setup, but could cause problems.</li>
</ul>
<p>auto_allow_new_peers=false:</p>
<ul>
<li>Trust is given on a case by case basis, this is the recommended configuration.</li>
</ul>
<p>Let's imagine that you have manually invited Bob to chat with you. Bob want's you to meet Alice and creates a group chat with both of you. During the synchronization, you device detects a new peer(Alice), and add it to the <strong>sys.Peer</strong> list.</p>
<p>If auto_allow_new_peers is set to 'true', you're device will allow Alice to directly connect with you. It makes the network stronger, as Alice will be able to see your message even if Bob is not connected. But it comes at the cost of some privacy, because you now share your IP address with Alice. In case of large communities, this setup will make your allowed peers very large, increasing the number of network connections, and increase resources usage.</p>
<p>If auto_allow_new_peers is set to 'false',</p>
<ul>
<li>a <strong>sys.AllowedPeer</strong> tuple is created with the status set to <strong>pending</strong></li>
<li>a <strong>PendingPeer</strong> event is triggered</li>
</ul>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">max_object_size_in_kb</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Defines the maximum size of an entity tuple. Object size should be kept relatively small to ensure efficient synchronization.</p>
<p>This parameter has a direct impact on the size of the buffers used to read and write data on the network
Increasing this value will increase the RAM usage of the application</p>
<p><strong>!!WARNING!!</strong> once your program is in production, decreasing this value will break the system. No data will be lost but the system will not be able to synchronized objects that are larger than the reduced value.</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">read_cache_size_in_kb</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Set the maximum cache size for the database reading threads. Increasing it can improve performances. Every read threads consumes up to that amount, meaning that increasing the &quot;parallelism&quot; configuration will increase the memory usage.</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">write_cache_size_in_kb</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Set the maximum of cache size for the database writing thread. increasing it may improve performances</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">write_buffer_length</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Write queries are buffered while the database thread is working. When the database thread is ready, the buffer is sent and is processed in one single transaction.
It greatly increase insertion and update rate, compared to autocommit. To get an idea of the performance difference, a very simple benchmark on a laptop with 100 000 insertions gives:</p>
<ul>
<li>Buffer size: 1      Insert/seconds: 55  &lt;- this is equivalent to autocommit</li>
<li>Buffer size: 10     Insert/seconds: 500</li>
<li>Buffer size: 100    Insert/seconds: 3000</li>
<li>Buffer size: 1000   Insert/seconds: 32000</li>
</ul>
<p>If one a buffered query fails, the transaction will be rolled back and every other queries in the buffer will fail too. This should not be an issue as INSERT query are not expected to fail. The only reasons to fail an insertion are a bugs or a system failure (like no more space available on disk), and in both case, it is ok to fail the last insertions batch.</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">announce_frequency_in_ms</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>how often (in milliseconds) an announces are sent over the network to meet peers to connect to.</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">enable_multicast</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Enable/disable multicast discovery, i.e. local network peer discovery</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">multicast_ipv4_interface</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-support z-class z-builtin z-ts">String</span>
</span></code></pre>
<p><em>Discret</em> uses the IP multicast feature to discover peers on local networks. On systems with multiple network interfaces, it might be necessary to provide the right ip adress for multicast to work properly. the default (let the OS choose for you) should work on most cases.</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"> <span class="z-entity z-name z-label z-ts">multicast_ipv4_group</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-support z-class z-builtin z-ts">String</span>
</span></code></pre>
<p>The multicast group that is used to perform peer discovery</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">pub</span> <span class="z-entity z-name z-label z-ts">enable_beacons</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Enable/Disable beacon peer discovery. I.e. meet peers over the Internet.</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">pub</span> <span class="z-entity z-name z-label z-ts">beacons</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">List</span><span class="z-keyword z-operator z-relational z-ts">&lt;</span><span class="z-variable z-other z-readwrite z-ts">BeaconConfig</span><span class="z-keyword z-operator z-relational z-ts">&gt;</span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></code></pre>
<p>List of Beacon servers that are used for peer discovery.
Here is a sample configuration in the TOML format:</p>
<pre data-lang="toml" class="language-toml z-code"><code class="language-toml" data-lang="toml"><span class="z-source z-toml"><span class="z-punctuation z-definition z-table z-array z-begin z-toml">[[</span><span class="z-meta z-tag z-table z-array z-toml"><span class="z-entity z-name z-table z-toml">beacons</span></span><span class="z-punctuation z-definition z-table z-array z-end z-toml">]]</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">hostname</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">&quot;</span>sever.com:4264<span class="z-punctuation z-definition z-string z-end z-toml">&quot;</span></span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">cert_hash</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">&quot;</span>weOsoMPwj976xqxRvLElsbb-gijWWn0netOtgPflZnk<span class="z-punctuation z-definition z-string z-end z-toml">&quot;</span></span>
</span><span class="z-source z-toml">
</span><span class="z-source z-toml"><span class="z-punctuation z-definition z-table z-array z-begin z-toml">[[</span><span class="z-meta z-tag z-table z-array z-toml"><span class="z-entity z-name z-table z-toml">beacons</span></span><span class="z-punctuation z-definition z-table z-array z-end z-toml">]]</span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">hostname</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">&quot;</span>192.168.1.8:4266<span class="z-punctuation z-definition z-string z-end z-toml">&quot;</span></span>
</span><span class="z-source z-toml"><span class="z-meta z-tag z-key z-toml"><span class="z-entity z-name z-tag z-toml">cert_hash</span></span> <span class="z-punctuation z-definition z-key-value z-toml">=</span> <span class="z-string z-quoted z-double z-basic z-toml"><span class="z-punctuation z-definition z-string z-begin z-toml">&quot;</span>weOsoMPwj976xqxRvLElsbb-gijWWn0netOtgPflZnk<span class="z-punctuation z-definition z-string z-end z-toml">&quot;</span></span>
</span></code></pre>
<p>A beacon defines two fields:</p>
<ul>
<li><em>hostname</em>: the server address</li>
<li><em>cert_hash</em>: The certificate <em>hash</em> used by the server. This value is generated at the start of the server.</li>
</ul>
<p>You will find information on how to start a beacon server and retrieve the <em>cert_hash</em> in the <a href="https://discretlib.github.io/doc/learn/configuration/beacon/">Beacon</a> section.</p>
<hr />
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">pub</span> <span class="z-entity z-name z-label z-ts">enable_database_memory_security</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Enable_memory_security: Prevents memory to be written into swap and zeroise memory after free.</p>
<p>Disabled by default because of a huge performance impact (about 50%). It should only be used if you're system requires a &quot;paranoid&quot; level of security.
When this feature is disabled, locking/unlocking of the memory address only occur for the internal SQLCipher
data structures used to store key material, and cryptographic structures.</p>
<p>source: <a href="https://discuss.zetetic.net/t/what-is-the-purpose-of-pragma-cipher-memory-security/3953">cipher_memory_security</a></p>

    <nav class="lower_nav">
        <div>
        </div>
        <div> <a href="https://discretlib.github.io/doc/learn/configuration/hardware/">Next: Hardware Key<i
                    class="fa fa-arrow-right"></i></a> 
        </div>
    </nav>
</article>





  </section>
  <section class="footer">
    <div> 
      Copyright © 2024 Adrien SALAIS. This site content is under the <a href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">CC-BY-SA</a> licence.     
      The Discret library is under the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">AGPL V3</a> licence. 
      The examples and the Flutter binding are under the <a href="https://en.wikipedia.org/wiki/MIT_License">MIT</a> licence
      <div />
  </section>
</body>

</html>
