<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <title>Discret Library</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <link rel="stylesheet" href="https://discretlib.github.io/doc/index.css">
  
</head>

<body>
  <section class="header-background"></section>
  <section class="content">
    <section class="header">
      <ul>
        <li>
          
          <a href="https://discretlib.github.io/doc/" class="discret">
            Discret
          </a>
        </li>
        <li>
          <section class="tutorial">
            <a href="">
              Tutorials
            </a>
          </section>
        </li>
        <li>
          <section class="learn">
            <a href="">
              Learn
              <i class="fa fa-caret-down"></i>
            </a>

            <section class="learn_menu">
              <ul>
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/">
                    Table Of Content
                  </a>
                </li>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/datamodel/">
                    Managing data
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/datamodel/schema/">
                      Schema and Entities
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/datamodel/mutation/">
                      Mutations and Deletions
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/datamodel/query/">
                      Queries
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/access_rights/">
                    Access Rights
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/access_rights/room/">
                      Rooms
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/access_rights/peer/">
                      Peer Management
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/access_rights/invites/">
                      Invitations
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/configuration/">
                    Configuration
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/configuration/configuration/">
                      Configuration
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/configuration/hardware/">
                      Hardware Key
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/configuration/beacon/">
                      The Beacon Server
                    </a>
                  </li>
                  
                </ul>
                
                
                <li>
                  <a href="https://discretlib.github.io/doc/learn/Api/">
                    API
                  </a>
                </li>
                <ul class="sub_menu">
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/Api/rust/">
                      Rust API
                    </a>
                  </li>
                  
                  <li>
                    <a href="https://discretlib.github.io/doc/learn/Api/flutter/">
                      Flutter API
                    </a>
                  </li>
                  
                </ul>
                
                
              </ul>
            </section>
          </section>
        </li>

        <section class="header_right">
          <li><a href="">Github</a></li>
          <li><a href="">Hire Me</a></li>
          <li><a href="/fr/" class="flag"><img src="/fr.svg" alt="french translation" /></a>
        </section>
      </ul>
    </section>


    

<section class="sticky">
    <nav class="menu">
        
        <ul>
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/">
                    Table Of Content
                </a>
            </li>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/datamodel/">
                    Managing data
                </a>
            </li>
            <ul class="sub_menu">
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/datamodel/schema/">
                        Schema and Entities
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/datamodel/mutation/">
                        Mutations and Deletions
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/datamodel/query/">
                        Queries
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/access_rights/">
                    Access Rights
                </a>
            </li>
            <ul class="sub_menu">
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/access_rights/room/">
                        Rooms
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/access_rights/peer/">
                        Peer Management
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/access_rights/invites/">
                        Invitations
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/configuration/">
                    Configuration
                </a>
            </li>
            <ul class="sub_menu">
                
                <li class="active" >
                    <a href="https://discretlib.github.io/doc/learn/configuration/configuration/">
                        Configuration
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/configuration/hardware/">
                        Hardware Key
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/configuration/beacon/">
                        The Beacon Server
                    </a>
                </li>
                
            </ul>
            
            
            <li >
                <a href="https://discretlib.github.io/doc/learn/Api/">
                    API
                </a>
            </li>
            <ul class="sub_menu">
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/Api/rust/">
                        Rust API
                    </a>
                </li>
                
                <li >
                    <a href="https://discretlib.github.io/doc/learn/Api/flutter/">
                        Flutter API
                    </a>
                </li>
                
            </ul>
            
            
        </ul>
        
    </nav>
</section>

<article>
    <h1>
        Configuration
    </h1>
    <p><em>Discret</em> provides some configuration options that will be passed to the engine at startup. </p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">parallelism</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Defines the global parellism capabilities. This number impact:</p>
<ul>
<li>the maximum number of room that can be synchronized in parallel,</li>
<li>the number of database readings threads</li>
<li>the number of signature verification threads</li>
<li>the number of shared buffers used for reading and writing data on the network</li>
<li>the depth of the channels that are used to transmit message accross services</li>
</ul>
<p>Larger numbers will provides better performances at the cost of more memory usage. Having a number larger that the number of CPU might not provides increased performances</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">auto_accept_local_device</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>When connecting with the same key_material on different devices, thoses devices exchanges their hardaware fingerprint to check wether they are allowed to connect.
This add an extra layer of security in the unlucky case where your secret material is shared by another person on the internet (which could be relatively frequent as users tends use weak passwords).</p>
<p>When connecting over the internet, new harware is allways silently rejected.</p>
<p>However, on local network we trust new hardware by default. This behaviors can be disabled by setting 'auto_accept_local_device' to false.
In this case, when a new device is detected on the local network:</p>
<ul>
<li>a sys.AllowedHardware will be created with the status:'pending'</li>
<li>a PendingHardware Event will be triggered</li>
<li>the current coonection attempt will be rejected</li>
</ul>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">auto_allow_new_peers</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Defines the behavior of the system when it discover a new peer while synchronizing a room.</p>
<p>auto_allow_new_peers=true:</p>
<ul>
<li>I implicitely trust friends of my friends. It is easy to setup, but could cause problems.</li>
</ul>
<p>auto_allow_new_peers=false:</p>
<ul>
<li>Trust is given on a case by case basis, this is the recommended configuration.</li>
</ul>
<p>Let's imagine that you have manually invited Bob to chat with you. Bob want's you to meet Alice and creates a group chat with both of you. During the synchronisation, you device detects a new peer(Alice), and add it to the sys.Peer list.</p>
<p>If auto_allow_new_peers is set to 'true', you're device will allow Alice to directly connect with you. It makes the network stronger, as Alice will be able to see your message even if Bob is not connected. But it comes at the cost of some privacy, because you now share your IP adress with Alice. In case of large communities, this setup will make your allowed peers very large, increasing the number of network connections, and increase ressources usage.</p>
<p>If auto_allow_new_peers is set to 'true',</p>
<ul>
<li>a sys.AllowedPeer object is created in the private room, with the status set to 'pending'</li>
<li>a PendingPeer event is triggered
It is up to the developer to intercept the event and decides what to do by updating the status to 'enabled' or 'disabled'</li>
</ul>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">max_object_size_in_kb</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Defines the maximum size of an entity tupple. Object size should be kept relatively small to ensure efficient synchronisation.</p>
<p>This parameter has a direct impact on the size of the buffers used to read and write data on the network
Increasing this value will increase the RAM usage of the application</p>
<p><strong>!!WARNING!!</strong> once your program is in production, decreasing this value will break the system. No data will be lost but the system will not be able to synchronized objects that are larger than the reduced value.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">read_cache_size_in_kb</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Set the maximum cache size for the database reading threads. Increasing it can improve performances. Every read threads consumes up to that amount, meaning that increasing the &quot;parallelism&quot; configuration will increase the memory usage.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">write_cache_size_in_kb</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Set the maximum of cache size for the database writing thread. increasing it may improvee performances</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">write_buffer_length</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>Write queries are buffered while the database thread is working. When the database thread is ready, the buffer is sent and is processed in one single transaction.
It greatly increase insertion and update rate, compared to autocommit. To get an idea of the perforance difference, a very simple benchmak on a laptop with 100 000 insertions gives:</p>
<ul>
<li>Buffer size: 1      Insert/seconds: 55  &lt;- this is equivalent to autocommit</li>
<li>Buffer size: 10     Insert/seconds: 500</li>
<li>Buffer size: 100    Insert/seconds: 3000</li>
<li>Buffer size: 1000   Insert/seconds: 32000</li>
</ul>
<p>If one a buffered query fails, the transaction will be rolled back and every other queries in the buffer will fail too. This should not be an issue as INSERT query are not expected to fail. The only reasons to fail an insertion are a bugs or a system failure (like no more space available on disk), and in both case, it is ok to fail the last insertions batch.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">announce_frequency_in_ms</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">integer</span>
</span></code></pre>
<p>how often (in milliseconds) an annouces are sent over the network to meet peers to connect to.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">enable_multicast</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Enable/disable multicast discovery, i.e. local network peer discovery</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-entity z-name z-label z-ts">multicast_ipv4_interface</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-support z-class z-builtin z-ts">String</span>
</span></code></pre>
<p><em>Discret</em> uses the IP multicast feature to discover peers on local networks. On systems with multiple network interfaces, it might be necessary to provide the right ip adress for multicast to work properly. the default (let the OS choose for you) should work on most cases.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"> <span class="z-entity z-name z-label z-ts">multicast_ipv4_group</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-support z-class z-builtin z-ts">String</span>
</span></code></pre>
<p>The multicast group that is used to perform peer discovery</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">pub</span> <span class="z-entity z-name z-label z-ts">enable_beacons</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Enable/Disable beacon peer discovery. I.e. meet peers over the Internet.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">pub</span> <span class="z-entity z-name z-label z-ts">beacons</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">List</span><span class="z-keyword z-operator z-relational z-ts">&lt;</span><span class="z-variable z-other z-readwrite z-ts">BeaconConfig</span><span class="z-keyword z-operator z-relational z-ts">&gt;</span><span class="z-punctuation z-separator z-comma z-ts">,</span>
</span></code></pre>
<p>List of Beacon servers that are used for peer discovery.</p>
<pre data-lang="js" class="language-js z-code"><code class="language-js" data-lang="js"><span class="z-source z-ts"><span class="z-variable z-other z-readwrite z-ts">pub</span> <span class="z-entity z-name z-label z-ts">enable_database_memory_security</span><span class="z-punctuation z-separator z-label z-ts">:</span> <span class="z-variable z-other z-readwrite z-ts">boolean</span>
</span></code></pre>
<p>Enable_memory_security: Prevents memory to be written into swap and zeroise memory after free.</p>
<p>Disabled by default because of a huge performance impact (about 50%). It should only be used if you're system requires a &quot;paranoid&quot; level of security.
When this feature is disabled, locking/unlocking of the memory address only occur for the internal SQLCipher
data structures used to store key material, and cryptographic structures.</p>
<p>source: https://discuss.zetetic.net/t/what-is-the-purpose-of-pragma-cipher-memory-security/3953</p>

    <nav class="lower_nav">
        <div>
        </div>
        <div> <a href="https://discretlib.github.io/doc/learn/configuration/hardware/">Next: Hardware Key<i
                    class="fa fa-arrow-right"></i></a> 
        </div>
    </nav>
</article>





  </section>
  <section class="footer">
    <div>The site design is a bad copy of the <a href="https://www.mkdocs.org/">MkDocs</a> website. The documentation
      takes a lot of inspiration from <a href="https://graphql.org/">GraphQL</a>.</div>

    <div> Copyright © 2024 Adrien SALAIS. This site content is under the <a
        href="https://creativecommons.org/licenses/by-sa/4.0/deed.en">CC-BY-SA</a> licence. The Discret library is
      under
      the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">AGPL V3</a> licence
      <div />
  </section>
</body>

</html>
